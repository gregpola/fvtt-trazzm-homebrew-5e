{"name":"Pack Tactics","type":"feat","img":"icons/creatures/mammals/wolf-shadow-black.webp","effects":[{"_id":"mqgJESSKxcvjERpT","changes":[{"key":"flags.midi-qol.onUseMacroName","mode":0,"value":"ItemMacro.Pack Tactics,preAttackRoll","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/creatures/mammals/wolf-shadow-black.webp","label":"Pack Tactics","origin":"Compendium.fvtt-trazzm-homebrew-5e.homebrew-racial-traits.oh5opaaRHp5ByzEF","transfer":true,"flags":{"dae":{"selfTarget":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":true},"core":{"statusId":""},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"tint":null}],"folder":null,"sort":0,"flags":{"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"_id":null,"name":"Pack Tactics","type":"script","author":"5vlmE3uiS7OIQTEf","img":"icons/svg/dice-target.svg","scope":"global","command":"if (args[0].macroPass === \"preAttackRoll\") {\n    if(!token || args[0].targets.length < 1) return;\n    const target = args[0].targets[0].object;\n    const creatures = MidiQOL.findNearby(CONST.TOKEN_DISPOSITIONS.HOSTILE,target,5);\n    const validCreatures = arrayRemove(creatures, token);\n    const workflow = await MidiQOL.Workflow.getWorkflow(args[0].uuid);\n    if(validCreatures.length === 0 || validCreatures.filter(t=>t.actor.effects.find(i=>i.label === \"Incapacitated\")).length === validCreatures.length) return;\n    else setProperty(workflow, 'advantage', true);\n}\n\nfunction arrayRemove(arr, value) {\n    return arr.filter(function(ele){\n        return ele != value;\n    });\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}},"core":{"sourceId":"Compendium.fvtt-trazzm-homebrew-5e.homebrew-racial-traits.oh5opaaRHp5ByzEF"},"scene-packer":{"hash":"9f9d15d7f109b01a71ad3efe149fdecc334b6881","sourceId":"Item.WY5mbmpjXSvHv6SV"}},"_id":"Epo1njlVH3Vl1dnR","system":{"description":{"value":"<p>You have advantage on an attack roll against a creature if at least one of your allies is within 5 feet of the creature and the ally isnâ€™t incapacitated.</p>\n\n","chat":"","unidentified":""},"source":"","activation":{"type":"","cost":0,"condition":""},"duration":{"value":null,"units":""},"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":"","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"requirements":"Kobold","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"5vlmE3uiS7OIQTEf":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1673042301937,"modifiedTime":1673042301937,"lastModifiedBy":"5vlmE3uiS7OIQTEf"}}
{"name":"Light Emanation","type":"feat","img":"icons/magic/light/explosion-star-glow-yellow.webp","system":{"description":{"value":"<p>If you are within 60 feet of it, you can speak its command word and cause it to emanate the light or daylight spell.</p>","chat":"","unidentified":""},"source":"","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"","recharge":{"value":null,"charged":false}},"effects":[{"label":"Light Emanation","icon":"icons/magic/light/explosion-star-glow-yellow.webp","origin":"Item.LKy1rDDA4Bbapq0P","duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"tv5PBm6k6gzPGJSn","changes":[{"key":"macro.itemMacro","mode":0,"value":"","priority":20}],"tint":null,"transfer":false,"flags":{"times-up":{},"dae":{"selfTarget":false,"selfTargetAlways":true,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"undefined","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"5vlmE3uiS7OIQTEf":3},"flags":{"scene-packer":{"hash":"79768ab97aeae327b63e8d661b563c83d1c60b22","sourceId":"Item.LKy1rDDA4Bbapq0P"},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Light Emanation","type":"script","scope":"global","command":"const version = \"10.0.0\";\nconst optionName = \"Driftglobe Light Emanation\";\nconst lightingFlagName = \"driftglobe-light\";\n\ntry {\n\tconst lastArg = args[args.length - 1];\n\tlet actor = MidiQOL.MQfromActorUuid(lastArg.actorUuid);\n\tlet actorToken = canvas.tokens.get(lastArg.tokenId);\n\t\n\tif (args[0] === \"on\") {\n\t\t// get and stash the current data\n\t\tvar tokenLighting = actorToken.document.light;\n\t\tDAE.setFlag(actor, lightingFlagName, {\n\t\t\tname : optionName,\n\t\t\tlightDim: tokenLighting.dim,\n\t\t\tlightBright: tokenLighting.bright,\n\t\t\tlightAngle: tokenLighting.angle,\n\t\t\tlightAlpha: tokenLighting.alpha,\n\t\t\tlightColor: tokenLighting.color,\n\t\t\tlightAnimationIntensity: tokenLighting.animation.intensity,\n\t\t\tlightAnimationSpeed: tokenLighting.animation.speed,\n\t\t\tlightAnimationType: tokenLighting.animation.type\n\t\t});\n\n\t\t// set the token lighting\n\t\tactorToken.document.update({\n\t\t\t\"light.dim\": 40, \n\t\t\t\"light.bright\": 20, \n\t\t\t\"light.angle\": 360, \n\t\t\t\"light.alpha\": 0.25,\n\t\t\t\"light.color\": \"#ffffff\",\t\t\t\n\t\t\t\"light.animation\": {\n\t\t\t\t\"type\": \"pulse\",\n\t\t\t\t\"speed\": 3,\n\t\t\t\t\"intensity\": 1\n\t\t\t}\n\t\t});\n\t\t\n\t}\n\telse if (args[0] === \"off\") {\n\t\t// reset the token lighting\n\t\tlet flag = DAE.getFlag(actor, lightingFlagName);\n\t\tif (flag) {\n\t\t\tactorToken.document.update({\n\t\t\t\t\"light.dim\": flag.lightDim, \n\t\t\t\t\"light.bright\": flag.lightBright, \n\t\t\t\t\"light.angle\": flag.lightAngle, \n\t\t\t\t\"light.alpha\": flag.lightAlpha,\n\t\t\t\t\"light.color\": flag.lightColor,\t\t\t\n\t\t\t\t\"light.animation\": {\n\t\t\t\t\t\"type\": flag.lightAnimationType,\n\t\t\t\t\t\"speed\": flag.lightAnimationSpeed,\n\t\t\t\t\t\"intensity\": flag.lightAnimationIntensity\n\t\t\t\t}\t\t\t\n\t\t\t});\n\t\t\tDAE.unsetFlag(actor, lightingFlagName);\n\t\t}\n\t}\n\n} catch (err) {\n    console.error(`${optionName}: ${version}`, err);\n}","author":"5vlmE3uiS7OIQTEf","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.LKy1rDDA4Bbapq0P"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.4","coreVersion":"10.291","createdTime":1675130048020,"modifiedTime":1675131404447,"lastModifiedBy":"5vlmE3uiS7OIQTEf"},"folder":null,"sort":0,"_id":"R4sBWyYE0lZptg1S"}
{"name":"Daylight Emanation","type":"feat","img":"icons/magic/light/beam-explosion-orange.webp","system":{"description":{"value":"<p>If you are within 60 feet of it, you can speak its command word and cause it to emanate the light or daylight spell. Once used, the daylight effect can't be used again until the next dawn.</p>","chat":"","unidentified":""},"source":"","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":1,"max":"1","per":"day","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"","recharge":{"value":null,"charged":false}},"effects":[{"label":"Daylight Emanation","icon":"icons/magic/light/beam-explosion-orange.webp","origin":"Item.LKy1rDDA4Bbapq0P","duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"tv5PBm6k6gzPGJSn","changes":[{"key":"macro.itemMacro","mode":0,"value":"","priority":20}],"tint":null,"transfer":false,"flags":{"times-up":{},"dae":{"selfTarget":false,"selfTargetAlways":true,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"undefined","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"5vlmE3uiS7OIQTEf":3},"flags":{"scene-packer":{"hash":"3f4e483a860b597f67b7b2c0f8b8929328fcd9c3","sourceId":"Item.nznb1a9I1ovBZG3D"},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Daylight Emanation","type":"script","scope":"global","command":"const version = \"10.0.0\";\nconst optionName = \"Driftglobe Dayight Emanation\";\nconst lightingFlagName = \"driftglobe-daylight\";\n\ntry {\n\tconst lastArg = args[args.length - 1];\n\tlet actor = MidiQOL.MQfromActorUuid(lastArg.actorUuid);\n\tlet actorToken = canvas.tokens.get(lastArg.tokenId);\n\t\n\tif (args[0] === \"on\") {\n\t\t// get and stash the current data\n\t\tvar tokenLighting = actorToken.document.light;\n\t\tDAE.setFlag(actor, lightingFlagName, {\n\t\t\tname : optionName,\n\t\t\tlightDim: tokenLighting.dim,\n\t\t\tlightBright: tokenLighting.bright,\n\t\t\tlightAngle: tokenLighting.angle,\n\t\t\tlightAlpha: tokenLighting.alpha,\n\t\t\tlightColor: tokenLighting.color,\n\t\t\tlightAnimationIntensity: tokenLighting.animation.intensity,\n\t\t\tlightAnimationSpeed: tokenLighting.animation.speed,\n\t\t\tlightAnimationType: tokenLighting.animation.type\n\t\t});\n\n\t\t// set the token lighting\n\t\tactorToken.document.update({\n\t\t\t\"light.dim\": 120, \n\t\t\t\"light.bright\": 60, \n\t\t\t\"light.angle\": 360, \n\t\t\t\"light.alpha\": 0.25,\n\t\t\t\"light.color\": \"#ffffff\",\t\t\t\n\t\t\t\"light.animation\": {\n\t\t\t\t\"type\": \"pulse\",\n\t\t\t\t\"speed\": 3,\n\t\t\t\t\"intensity\": 1\n\t\t\t}\n\t\t});\n\t\t\n\t}\n\telse if (args[0] === \"off\") {\n\t\t// reset the token lighting\n\t\tlet flag = DAE.getFlag(actor, lightingFlagName);\n\t\tif (flag) {\n\t\t\tactorToken.document.update({\n\t\t\t\t\"light.dim\": flag.lightDim, \n\t\t\t\t\"light.bright\": flag.lightBright, \n\t\t\t\t\"light.angle\": flag.lightAngle, \n\t\t\t\t\"light.alpha\": flag.lightAlpha,\n\t\t\t\t\"light.color\": flag.lightColor,\t\t\t\n\t\t\t\t\"light.animation\": {\n\t\t\t\t\t\"type\": flag.lightAnimationType,\n\t\t\t\t\t\"speed\": flag.lightAnimationSpeed,\n\t\t\t\t\t\"intensity\": flag.lightAnimationIntensity\n\t\t\t\t}\t\t\t\n\t\t\t});\n\t\t\tDAE.unsetFlag(actor, lightingFlagName);\n\t\t}\n\t}\n\n} catch (err) {\n    console.error(`${optionName}: ${version}`, err);\n}","author":"5vlmE3uiS7OIQTEf","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.LKy1rDDA4Bbapq0P"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.4","coreVersion":"10.291","createdTime":1675130048020,"modifiedTime":1675132037945,"lastModifiedBy":"5vlmE3uiS7OIQTEf"},"folder":null,"sort":0,"_id":"W7i4OKQMCr275G2w"}
